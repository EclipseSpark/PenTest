require 'openssl'

hash = "buffer goes
        here ee"

sha1_hash = "0xchash_here"
def string2bin(s)
        s = s.split(' ').collect! {|n| n.to_i(16)}
        s.pack('C*')
end
#key = "SYMETRIC KEY"
key = string2bin(hash)

thefile = "wordlist.txt"

File.open(thefile, "rb" ).each_line do |line|
        found = OpenSSL::HMAC.hexdigest(OpenSSL::Digest.new('sha1'), key, line.strip)
        puts line if "0x#{found}" == sha1_hash
end
